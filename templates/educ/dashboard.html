{{ define "content"}}
<h3  class="dashboard-header"> Welcome {{ .Username }}</h3>
<hr>
<div class="col-xl-12 col-sm-12 mb-xl-0 mb-4">
  <br>
  <div class="card">
    <div class="card-header p-3 pt-2">
        <div class="icon icon-lg icon-shape bg-gradient-dark shadow-dark text-center border-radius-xl mt-n4 position-absolute">
            <i class="material-icons opacity-10">dashboard</i>
        </div>
        <div class="text-end">
            <input class="search-bar" type="text" name="search-student" id="search-student" placeholder="Search...">
            <button class="btn btn-secondary btn-sm mb-0 button-text" id="add_student" data-target="#addcollege_modal" data-toggle="modal" data-backdrop="static" data-keyboard="false"> Add Colleges</button>
        </div>
        <div class="text pt-5">
          <div class="table-responsive">
                <table class="table align-items-center">
                    <thead>
                        <tr>
                            <th class="text-uppercase text-secondary text-m font-weight-bolder opacity-9 table-textheader">
                                College
                            </th>
                            <th class="text-uppercase text-secondary text-m font-weight-bolder opacity-9 table-textheader">
                                Courses
                            </th>
                            <th class="text-uppercase text-secondary text-m font-weight-bolder opacity-9 table-textheader">
                                Course Counts
                            </th>
                            <th class="text-uppercase text-secondary text-m font-weight-bolder opacity-9 table-textheader">
                                Students Enrolled
                            </th>
                        </tr>
                    </thead>
                    <tbody id="college-listbody">
                    </tbody>
                </table>
          </div>
        </div>
    </div>
  </div>
</div>

<!-- Add College Modal -->
<div class="modal fade" tabindex="-1" role="dialog" id="addcollege_modal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title dashboard-header">Add College</h5>
      </div>
      <div class="modal-body">
          <div class="form-group mb-3">
              <form method="POST">
                  <input type="text" id="college" placeholder="College Name" class="form-control"><br>
                  <input type="text" id="collegedesc" placeholder="College Description" class="form-control"><br>
                  <input type="text" id="fieledmajor" placeholder="Field Major" class="form-control"><br>
                  <input type="email" id="collegeemail" placeholder="College Email Address" class="form-control"><br>
                  <input type="number"  id="collegecnumber" placeholder="College Contact Number" class="form-control"><br>
              </form>
          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" id="addcollege_save">Save changes</button>
        <button type="button" class="btn btn-secondary" id="addcollege_close" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
{{ end }}
{{ define "script" }}
<script>
  var collegetablelist = $('#college-listbody')
  window.onload = setup();

  function setup(){
    collegetable()
  }
  function collegetable(){
    var $query = "/admin/api/d/college/read/?"

    // For displaying Query
    $.get($query, function (response)
    {
      var college = response.result;
      $.each(college, function(_, college)
      {
        collegetablelist.append(
          $("<tr>").append(
            $("<td>").attr("class", "text-uppercase text-secondary text-m").text(college.CollegeName),
            $("<td>").attr("class", "text-uppercase text-secondary text-m").text(college.Courses),
            $("<td>").attr("class", "text-uppercase text-secondary text-m").text(college.CoursesCount),
            $("<td>").attr("class", "text-uppercase text-secondary text-m").text(college.StudentsEnrolled),
          )
          )
      });
    }, "json");
  }

  $("#addcollege_save").on("click", function(){
    $("#addcollege_modal").fadeOut(100)
    $.ajax({
      "method": "POST",
      "data" : {
        "data-action" : "new_college",
        "college" : $("[id='college']").val(),
        "collegedesc" : $("[id='collegedesc']").val(),
        "fieledmajor" : $("[id='fieledmajor']").val(),
        "collegeemail" : $("[id='collegeemail']").val(),
        "collegecnumber" : $("[id='collegecnumber']").val(),
      },
      "success": function (data)
      {
        Swal.fire({
        position: 'middle',
        icon: 'success',
        title: 'Courses added succesfully',
        showConfirmButton: false,
        timer: 1500
        }).then((result) => {
            $(location).attr('href', '/educ/college/')
        });
      }
    })
  })
</script>
{{ end }}